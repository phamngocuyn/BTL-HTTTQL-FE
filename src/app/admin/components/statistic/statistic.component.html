<div class="container mt-4">
  <table class="table caption-top align-middle table-bordered">
    <caption class="text-primary fs-3 text">
      <h3 class="col-4">Thống kê hóa đơn ({{selectedYear}})</h3>
    </caption>
  </table>

  <div>
    <label for="yearSelect">Chọn năm:</label>
    <select id="yearSelect" (change)="onYearChange($event)">
      <option *ngFor="let year of years" [value]="year">{{ year }}</option>
    </select>
  </div>

  <div class="row mt-4">
    <div class="col-md-6">
      <div class="info-box bg-light p-4 mb-4">
        <h4 class="info-title">Tổng số lượng sản phẩm đã bán</h4>
        <p class="info-value">{{ totalQuantitySold }}</p>
      </div>
    </div>
    <div class="col-md-6">
      <div class="info-box bg-light p-4 mb-4">
        <h4 class="info-title">Tổng doanh thu</h4>
        <p class="info-value">{{ totalRevenue | currency:'VND' }}</p>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="col-lg-6 col-md-12">
        <h3 class="text-primary">Biểu đồ đơn hàng theo tháng</h3>
      <div class="chart-container" style="position: relative; height:40vh; width:80vw">
        <canvas id="monthlyOrdersChart"></canvas>
      </div>
    </div>
    <div class="col-lg-6 col-md-12">
      <h3 class="text-primary">Biểu đồ doanh thu theo tháng</h3>
      <div class="chart-container" style="position: relative; height:40vh; width:80vw">
        <canvas id="monthlyRevenueChart"></canvas>
      </div>
    </div>
  </div>

  <div class="row mt-5">
    <div class="col-md-6">
      <div class="chart-container" style="position: relative; height:40vh; width:80vw">
        <h3 class="text-primary">Biểu đồ doanh thu theo danh mục sản phẩm</h3>
        <canvas id="categoryRevenueChart" width="400" height="400"></canvas>
      </div>
    </div>
    <div class="col-md-6">
      <h3 class="text-primary">Biểu đồ tổng sản lượng bán ra theo từng tháng trong năm</h3>
      <div class="chart-container" style="position: relative; height:40vh; width:80vw">
        <canvas id="monthlyQuantityChart"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- <div class="container mt-5">
  <button class="btn btn-primary" (click)="exportToExcel()">Xuất báo cáo ra Excel</button>
</div> -->
<div class="container mt-5">
  <button class="btn btn-primary" (click)="exportToWord()">Xuất báo cáo thành file word</button>
</div>
